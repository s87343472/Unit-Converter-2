# 优化计划

## 1. 核心功能优化

### 1.1 转换功能
- 优化转换算法
- 提高计算精度
- 添加常用单位组合

### 1.2 用户界面
- 简化操作流程
- 优化移动端适配
- 改进错误提示

### 1.3 多语言支持
- 优化语言切换
- 完善翻译内容
- 改进 URL 结构

## 2. 性能优化

### 2.1 加载性能
- 组件懒加载
- 资源预加载
- 代码分割

### 2.2 运行性能
- 减少重渲染
- 优化状态管理
- 改进数据缓存

### 2.3 构建优化
- 压缩资源
- Tree-shaking
- 模块分析

## 3. 用户体验

### 3.1 交互优化
- 添加加载状态
- 优化动画效果
- 改进反馈机制

### 3.2 可访问性
- 键盘导航
- 屏幕阅读
- 颜色对比度

### 3.3 响应式设计
- 移动优先
- 断点优化
- 触摸支持

## 4. 代码质量

### 4.1 类型系统
- 完善类型定义
- 严格类型检查
- 运行时类型验证

### 4.2 测试覆盖
- 单元测试
- 集成测试
- E2E 测试

### 4.3 代码规范
- ESLint 配置
- Prettier 格式化
- 提交检查

## 5. 实施计划

### 5.1 第一阶段（核心功能）
- [ ] 优化转换功能
- [ ] 改进多语言支持
- [ ] 完善错误处理

### 5.2 第二阶段（性能优化）
- [ ] 实现懒加载
- [ ] 优化构建配置
- [ ] 改进缓存策略

### 5.3 第三阶段（体验优化）
- [ ] 添加动画效果
- [ ] 优化移动端
- [ ] 提升可访问性

## 6. 监控指标

### 6.1 性能指标
- 首次加载时间
- 交互响应时间
- 内存使用情况

### 6.2 用户指标
- 使用时长
- 转化率
- 错误率

### 6.3 代码指标
- 测试覆盖率
- 构建大小
- 代码质量分数

## 7. 单位转换组件优化

### 7.1 布局优化

1. 页面结构优化：
   - 统一导航栏高度为 60px
   - 内容区域最大宽度限制为 1280px
   - 标准间距设置为 24px
   - 统一圆角为 6px

2. 响应式布局优化：
   - 桌面端采用两列布局
   - 移动端采用单列布局
   - 优化移动端交互体验

### 7.2 交互优化

1. 输入优化：
   - 支持科学计数法输入
   - 限制最大输入长度
   - 优化数字键盘体验
   - 添加输入提示

2. 单位选择优化：
   - 优化单位列表展示
   - 添加单位搜索功能
   - 支持键盘导航
   - 记住用户选择

3. 结果展示优化：
   - 优化结果列表样式
   - 添加复制功能
   - 优化数值格式化
   - 添加动画效果

### 7.3 性能优化

1. 渲染优化：
   - 使用 React.memo 优化纯组件
   - 实现虚拟列表
   - 优化重渲染逻辑
   - 添加加载状态

2. 计算优化：
   - 实现计算结果缓存
   - 优化防抖处理
   - 优化大数计算
   - 处理边界情况

### 7.4 可访问性优化

1. 键盘支持：
   - 完整的键盘导航
   - 快捷键支持
   - 焦点管理
   - Tab 键顺序优化

2. 屏幕阅读：
   - ARIA 标签支持
   - 语义化结构
   - 状态提示
   - 错误反馈

### 7.5 国际化优化

1. 文本翻译：
   - 完善单位名称翻译
   - 优化错误提示翻译
   - 添加单位说明
   - 支持 RTL 布局

2. 数值本地化：
   - 千分位格式化
   - 小数点显示
   - 科学计数法显示
   - 货币格式化

## 8. 实施时间表

### 8.1 第一阶段（1周）
- [ ] 实现基础布局优化
- [ ] 完成响应式适配
- [ ] 优化基本交互

### 8.2 第二阶段（2周）
- [ ] 实现性能优化
- [ ] 添加高级功能
- [ ] 完善错误处理

### 8.3 第三阶段（1周）
- [ ] 优化可访问性
- [ ] 完善国际化
- [ ] 进行测试和调优

OK，继续完善文档。

以下是更新后的 `optimization_plan.md` 文档，主要添加了关于多语言支持的说明：

---

# 单位转换工具交互优化方案

## 1. 背景

随着项目的发展，我们发现当前的交互流程存在一些效率问题。本文档旨在提出一个优化方案，以提升用户体验和使用效率，并作为后续开发的指导。

## 2. 现状分析

### 2.1 当前交互流程

1. 首页：展示所有单位类型入口，无实际功能
2. 单位类型页：展示该类型下的所有转换选项
3. 具体转换页：实际的转换功能

### 2.2 存在的问题

1. 交互层级过深（需要 3 次点击才能使用功能）
2. 页面跳转过多，影响用户体验
3. 首页和分类页缺乏实际功能，降低了效率

## 3. 优化方案

### 3.1 新的交互逻辑

1. 首页直接提供转换功能
2. 左侧导航 + 右侧功能区的布局
3. 动态切换不同转换类型，无需页面跳转

### 3.2 具体改进

1. 首页布局调整：

    *   左侧：单位类型导航菜单 (使用 `CategoryNav` 组件)
    *   右侧：转换功能区域 (使用 `UnitConverter` 组件)
    *   默认显示最常用的转换类型（如米转厘米）
2. 组件结构：

    ```jsx
    <Layout>
      <Sidebar>
        <CategoryNav categories={[...]} />
      </Sidebar>
      <Main>
        <UnitConverter type={selectedType} />
        <QuickAccess conversions={commonConversions} />
      </Main>
    </Layout>
    ```
3. 功能特性：
    *   实时转换：输入数值后，立即显示转换结果。
    *   无刷新切换单位类型：点击左侧导航菜单，右侧转换功能区域动态切换到相应的单位类型，无需刷新页面。
    *   保留详细页面的 URL 访问：用户仍然可以通过 URL 直接访问具体的转换页面 (例如：`/zh/length/m-to-cm`)。
    *   支持快捷方式和收藏功能：用户可以将常用的转换类型添加到快捷方式 (通过 `QuickAccess` 组件实现)，或者收藏起来 (通过 `favorites` 全局状态实现)。

## 4. 实施计划

### 4.1 第一阶段：基础组件开发 (v0.3.0)

1. 创建通用的 `UnitConverter` 组件：
    *   支持所有单位类型的转换
    *   响应式设计，适配不同屏幕尺寸
    *   完善的错误处理机制
    *   已实现功能：
        - 输入限制（20位数字，10位小数）
        - 实时错误提示
        - 科学计数法处理
        - 复制粘贴支持
        - 单位选择优化
    *   待优化项：
        - 输入防抖处理
        - 大数计算优化
        - 移动端适配优化
2. 开发 `QuickAccess` 组件：
    *   显示常用转换类型列表。
    *   支持自定义排序 (例如：用户可以将常用的转换类型拖动到前面)。
    *   快捷跳转功能 (例如：点击列表中的某个转换类型，可以直接跳转到该转换类型的页面)。
3. 开发 `LanguageSwitcher` 组件：
    *   用于切换网站的语言。
    *   使用 `useTranslation` Hook 获取当前语言和设置语言的函数。
    *   切换语言后更新 URL 中的语言代码，并重新加载当前页面的数据。
4. 开发 `LanguageProvider` 组件：
    *   使用 React Context 提供当前语言环境。
    *   加载和解析语言文件 (例如：`public/locales/en/common.json`、`public/locales/zh/common.json` 等)。
    *   提供 `t` 函数用于翻译文本。

### 4.2 第二阶段：首页改造 (v0.3.0 - v0.4.0)

1. 实现新的布局结构 (左侧导航 + 右侧功能区)。
2. 集成 `UnitConverter` 和 `QuickAccess` 组件到首页。
3. 添加动态切换功能：点击左侧导航菜单，右侧 `UnitConverter` 组件动态切换到相应的单位类型。
4. 优化移动端显示：在小屏幕上，可以将左侧导航菜单隐藏，通过一个菜单按钮来触发。
5. 集成 `LanguageSwitcher` 组件，实现多语言切换功能。

### 4.3 第三阶段：功能完善 (v0.4.0 - v1.0.0)

1. 添加历史记录功能：记录用户的转换历史，方便用户查看和重复使用 (通过 `history` 全局状态和 `ConversionHistory` 组件实现)。
2. 实现收藏功能：用户可以将常用的转换类型收藏起来 (通过 `favorites` 全局状态实现)。
3. 优化 SEO 相关配置：根据 `seo.md` 文档中的建议，优化页面的标题、描述、关键词等。
4. 添加数据统计功能：统计用户的行为数据，例如常用的转换类型、搜索的关键词等，以便进一步优化产品 (例如：使用 Google Analytics)。

## 5. 技术要点

### 5.1 状态管理

```typescript
interface ConversionState {
  selectedType: string; // 当前选中的转换类型，例如："length"、"weight"
  selectedConversion: string; // 当前选中的具体转换，例如："m-to-cm"
  inputValue: number; // 输入的数值
  fromUnit: string; // 转换前的单位
  toUnit: string; // 转换后的单位
  result: number; // 转换结果
}
```

*   使用 `useState` 和 `useReducer` 管理组件内部的状态。
*   使用 Context API 管理全局状态 (例如：`favorites`、`history`、`language`、`theme` 等)。
*   使用 `localStorage` 持久化用户偏好 (例如：`language`、`theme`、`favorites` 等)。

### 5.2 路由处理

*   保持 URL 同步：当用户切换转换类型时，更新 URL 中的参数 (例如：`/zh/length/m-to-cm`)。
*   支持直接访问具体转换页面：用户可以通过 URL 直接访问具体的转换页面 (例如：`/zh/length/m-to-cm`)。
*   处理后退 / 前进导航：当用户点击浏览器的后退或前进按钮时，页面能够正确地响应。
*   多语言路由：使用 Next.js 的 i18n 路由功能，支持多语言版本的 URL (例如：`/en/length/m-to-cm`、`/zh/length/m-to-cm`)。

### 5.3 性能优化

1. 组件懒加载：使用 `React.lazy` 和 `Suspense` 懒加载不常用的组件，例如一些专业计算功能的组件。
2. 计算结果缓存：使用 `useMemo` 缓存计算结果，避免重复计算。
3. 防抖处理：对输入框的 `onChange` 事件进行防抖处理，避免频繁触发计算和更新。
4. 预加载常用转换：在用户进入页面时，可以预加载一些常用的转换类型的数据。

### 5.4 多语言支持

1. 使用 `LanguageProvider` 组件提供当前语言环境和加载语言文件的方法。
2. 使用 `useTranslation` Hook 在组件中获取当前语言和翻译文本。
3. 在 `app/[lang]/layout.tsx` 中使用 `LanguageProvider` 组件包裹整个应用。
4. 在 `LanguageSwitcher` 组件中，使用 `useRouter` 和 `usePathname` Hook 更新 URL 中的语言代码。
5. 在 `generateMetadata` 方法中，根据当前语言生成不同的页面标题和描述，并使用 `alternates` 属性配置 `hreflang` 标签。

## 6. 测试计划

### 6.1 单元测试

1. 转换逻辑测试：测试所有单位转换函数的正确性 (例如：`kgToLb`、`mToCm` 等)。
2. 组件渲染测试：测试组件是否正确渲染，包括不同的 props 和状态。
3. 用户交互测试：测试用户的交互行为，例如输入数值、选择单位、点击按钮等。
4. 多语言测试：测试 `LanguageProvider` 和 `useTranslation` 是否正常工作，以及 `LanguageSwitcher` 组件是否能够正确切换语言。

### 6.2 集成测试

1. 路由导航测试：测试页面之间的跳转是否正确。
2. 状态管理测试：测试全局状态和局部状态是否正确更新。
3. API 集成测试：测试前端组件与 API 之间的交互是否正常。
4. 多语言集成测试：测试切换语言后，页面内容是否正确更新，URL 是否正确改变。

### 6.3 性能测试

1. 首次加载性能：测试页面的首次加载时间。
2. 交互响应时间：测试用户的交互操作的响应时间，例如输入数值、选择单位、切换转换类型等。
3. 内存占用监控：监控页面的内存占用情况，避免内存泄漏。

## 7. 预期效果

### 7.1 用户体验提升

1. 减少操作步骤：用户可以在首页直接进行常用的单位转换，无需多次点击跳转。
2. 提高转换效率：实时转换和无刷新切换单位类型，可以大大提高用户的转换效率。
3. 更直观的界面：新的布局和交互方式更加直观和易用。

### 7.2 技术指标

1. 首页加载时间 < 2s
2. 转换响应时间 < 100ms
3. 页面切换时间 < 300ms (通过代码分割和预加载实现)

## 8. 后续优化

### 8.1 功能扩展

1. 添加更多单位类型：根据用户的需求，添加更多的单位类型。
2. 支持自定义单位：允许用户添加自定义的单位。
3. 添加单位换算公式说明：为每个转换类型提供详细的公式说明和推导过程。

### 8.2 性能优化

1. 实现 PWA：将网站升级为 PWA，提高离线访问能力和用户体验。
2. 添加离线支持：使用 Service Worker 缓存数据，支持离线使用。
3. 优化移动端体验：针对移动端设备进行更精细的优化。

## 9. 时间节点

1. 第一阶段：5 个工作日 (v0.3.0)
    *   基础组件开发 (`UnitConverter`、`QuickAccess`、`LanguageSwitcher`、`LanguageProvider`)
    *   单元测试编写
2. 第二阶段：3 个工作日 (v0.3.0 - v0.4.0)
    *   首页改造
    *   集成测试
3. 第三阶段：4 个工作日 (v0.4.0 - v1.0.0)
    *   功能完善 (历史记录、收藏、SEO、数据统计)
    *   性能优化
    *   文档更新

---

接下来，我将更新 `test-guidelines.md` 和 `seo.md`，将多语言相关的测试和 SEO 优化补充进去，并尽快提交给你。

# 图标系统优化

## 1. 加载性能优化

### 1.1 代码分割
- 实现图标的按需加载
- 使用动态导入减少初始包大小
- 配置 webpack/rollup 的 tree-shaking

### 1.2 SVG 优化
- 使用 SVGO 压缩 SVG 代码
- 移除不必要的属性和元数据
- 最小化路径数据
- 合并相似路径

### 1.3 缓存策略
- 实现图标组件的缓存
- 使用 React.memo 避免不必要的重渲染
- 配置适当的缓存头部

## 2. 渲染性能优化

### 2.1 组件优化
- 优化组件的重渲染逻辑
- 使用 React.memo 包装图标组件
- 实现虚拟滚动（针对图标列表）

### 2.2 动画优化
- 使用 CSS transform 代替位置属性
- 实现平滑的过渡效果
- 优化动画帧率

### 2.3 响应式优化
- 根据屏幕尺寸加载不同大小的图标
- 优化移动端的触摸区域
- 实现合适的间距和布局

## 3. 可访问性优化

### 3.1 语义化
- 添加适当的 ARIA 标签
- 提供图标的文字描述
- 确保键盘可访问性

### 3.2 视觉优化
- 确保足够的对比度
- 提供合适的点击区域
- 添加焦点状态样式

### 3.3 交互优化
- 添加合适的悬停效果
- 实现清晰的反馈机制
- 优化触摸设备的交互

## 4. 维护性优化

### 4.1 文档完善
- 添加详细的使用说明
- 提供示例和最佳实践
- 维护更新日志

### 4.2 测试覆盖
- 添加单元测试
- 实现视觉回归测试
- 添加性能测试

### 4.3 工具支持
- 添加图标预览工具
- 实现自动化构建流程
- 提供图标管理界面

## 5. 实施计划

### 第一阶段：基础优化
- [ ] 实现 SVG 压缩
- [ ] 配置代码分割
- [ ] 添加基本的缓存策略

### 第二阶段：性能优化
- [ ] 实现组件缓存
- [ ] 优化动画性能
- [ ] 改进响应式支持

### 第三阶段：可访问性
- [ ] 添加 ARIA 支持
- [ ] 优化键盘访问
- [ ] 改进视觉反馈

### 第四阶段：工具支持
- [ ] 开发预览工具
- [ ] 实现自动构建
- [ ] 完善文档系统

## 6. 监控指标

### 6.1 性能指标
- 首次加载时间
- 交互响应时间
- 内存使用情况
- 动画帧率

### 6.2 可用性指标
- 可访问性评分
- 用户满意度
- 错误报告率
- 使用统计

### 6.3 维护指标
- 代码覆盖率
- 构建时间
- 文档完整度
- 更新频率
